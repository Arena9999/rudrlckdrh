<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>CVA 측정</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                {% set uid = session.get('user_id', '') | string %}
                {% if uid.startswith('guest') %}
                    <a href="{{ url_for('logout') }}">
                        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="logo" height="30">
                    </a>
                {% else %}
                    <a href="{{ url_for('index') }}">
                        <img src="{{ url_for('static', filename='images/logo.png') }}" alt="logo" height="30">
                    </a>
                {% endif %}
            </div>
            <div class="menu">
                {% if uid and not uid.startswith('guest') %}
                    <a href="{{ url_for('logout') }}">로그아웃</a>
                    <a href="{{ url_for('records.records') }}">기록 보기</a>
                {% else %}
                    <a href="{{ url_for('signup.register') }}">회원가입</a>
                    <a href="{{ url_for('login.login') }}">로그인</a>
                {% endif %}
                <a href="{{ url_for('user_service.user_service') }}">거북목 개선 방법</a>
            </div>
        </nav>
    </header>

    <main>
        <div class="cva-container">
            <!-- 카메라 화면 -->
            <div class="camera-wrapper">
                <video id="video" autoplay playsinline></video>
                <canvas id="canvas"></canvas>
                <div id="status">CVA: --, 상태: --</div>
                <div id="controls"></div>

                {% if uid and not uid.startswith('guest') %}
                    <div class="lcapture">
                        <button id="captureBtn">사진 찍기</button>
                        <button id="recordBtn">영상 촬영</button>
                        <div id="recording-time" style="margin-top:10px; font-weight:bold; font-size:14px; color:red;"></div>
                        <span id="countdownDisplay" style="display:block; margin-top:10px; font-weight:bold; font-size:12px;"></span>
                    </div>
                {% endif %}
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-links">
            <a href="{{ url_for('footer.feedback') }}">피드백/버그 제보</a> |
            <a href="{{ url_for('footer.FAQ') }}">FAQ</a> |
            <a href="{{ url_for('footer.security') }}">보안 안내</a> |
            <a href="{{ url_for('footer.TAC') }}">약관 및 개인정보 처리방침</a>
        </div>
        <p>© 2025 웹 서비스 플랫폼. All rights reserved.</p>
    </footer>

    <!-- Mediapipe 및 스크립트 -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose@0.5/pose.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script>
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>